var Ze=Object.defineProperty;var et=(e,t,n)=>t in e?Ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var de=(e,t,n)=>et(e,typeof t!="symbol"?t+"":t,n);import{r as s,j as x}from"./index-CbrSqKmO.js";function Ie(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=Ie(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function q(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=Ie(e))&&(r&&(r+=" "),r+=t);return r}function Me(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=Object.keys(e),r=Object.keys(t),o=n.length;if(r.length!==o)return!1;for(let l=0;l<o;l+=1){const f=n[l];if(e[f]!==t[f]||!Object.prototype.hasOwnProperty.call(t,f))return!1}return!0}function we(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=e.length;if(t.length!==n)return!1;for(let r=0;r<n;r+=1)if(e[r]!==t[r])return!1;return!0}function ce(e,t){if(Object.is(e,t))return!0;if(Array.isArray(e)&&Array.isArray(t))return we(e,t)?!0:e.length===t.length&&e.findIndex(r=>typeof r=="object"&&r!=null)>-1?e.every((r,o)=>Array.isArray(r)?we(r,t[o]):typeof r=="object"&&r!=null?Me(r,t[o]):Object.is(r,t[o])):!1;if(e instanceof Map&&t instanceof Map){const n=Array.from(e.keys()),r=Array.from(t.keys());if(ce(n,r)){const o=Array.from(e.values()),l=Array.from(t.values());if(ce(o,l))return!0}return!1}return typeof e=="object"&&e!=null?Me(e,t):!1}function Te(e){const t=e(),n=s.useRef(t);return ce(t,n.current)||(n.current=t),n.current}function Y(e){return"key"in e?e.key:e.dataIndex}function fe(e,t){return typeof t=="function"?t(e):e[t]}function G(e){return e==="left"}function Q(e){return e==="right"}function je(e){return G(e)||Q(e)}const Ne=s.createContext(null);function Re(){const e=s.useContext(Ne);if(e==null)throw new Error("useColumnSizes provider not found");return e}const Be=s.createContext(null);function tt(e){const{columns:t,children:n}=e,{widthList:r}=Re(),o=s.useMemo(()=>t.map(i=>({key:Y(i),fixed:i.fixed})),[t]),l=s.useMemo(()=>{let i=0;const C=o.reduce((p,S,M)=>{const{fixed:g,key:y}=S;return G(g)&&(p[M]=i,i+=r.get(y)??0),p},[]);let m=0;const c=o.reduceRight((p,S,M)=>{const{fixed:g,key:y}=S;return Q(g)&&(p[M]=m,m+=r.get(y)??0),p},[]);return o.reduce((p,S,M)=>{const{key:g,fixed:y}=S;return G(y)?(p.set(g,C[M]),p):(Q(y)&&p.set(g,c[M]),p)},new Map)},[o,r]),f=Te(()=>o),u=Te(()=>l),d=s.useMemo(()=>({size:u,fixed:f}),[f,u]);return x.jsx(Be.Provider,{value:d,children:n})}function ze(){const e=s.useContext(Be);if(e==null)throw new Error("useTableSticky provider not found");return e}function P(e,t,n){return typeof t=="function"?t(e,n):e}function nt(e,t,n){const{render:r}=n,o=t;if("dataIndex"in n){const l=n.dataIndex;return typeof r!="function"?o[l]:r(o[l],t,e)}return(r==null?void 0:r(t,t,e))??null}function rt(e){const{className:t,style:n,column:r,rowData:o,rowIndex:l,renderCell:f,...u}=e,{align:d,fixed:i,onCell:C}=r,m=Y(r),{size:c}=ze(),{className:p,style:S,colSpan:M,rowSpan:g,...y}=(C==null?void 0:C(o,l))??{};return M===0||g===0?null:P(x.jsx("td",{...u,...y,colSpan:M,rowSpan:g,className:q("virtual-table-cell",d!=null&&`virtual-table-align-${d}`,je(i)&&"virtual-table-sticky-cell",t,r.className,p),style:{...n,...S,left:G(i)?c.get(m):void 0,right:Q(i)?c.get(m):void 0},"data-col-key":m,children:nt(l,o,r)}),f,{column:r})}const ot=s.memo(rt),st=e=>{const{columns:t,onColumnSizesMeasure:n}=e,r=n!=null,o=new Map,l=s.useRef(new Map);return x.jsx("colgroup",{ref:()=>{r&&(ce(o,l.current)||(n(o),l.current=o))},children:t.map(f=>{const{key:u}=f;if(f.type==="blank")return x.jsx("col",{className:"blank",style:{width:f.width}},u);const{column:d}=f;return x.jsx("col",{ref:i=>{i==null||!r||o.set(u,i.offsetWidth)},style:{width:d.width,minWidth:d.minWidth}},u)})})},Fe=s.memo(st),lt=/auto|scroll|overlay|hidden/;function Oe(e){return e instanceof Node?e.nodeType===1:!1}function ct(e,t=window){let n=e;for(;n!==t&&Oe(n);){if(n===document.body)return t;const{overflow:r,overflowY:o,overflowX:l}=window.getComputedStyle(n);if(lt.test(r+o+l))return n;n=n.parentNode}return e.ownerDocument.defaultView??window}function pe(e){return Object.prototype.toString.call(e)==="[object Window]"}function it(e){return Object.prototype.toString.call(e)==="[object HTMLDocument]"}function De(e){return Object.prototype.toString.call(e)==="[object HTMLHtmlElement]"}function Le(e){return it(e)?e.scrollingElement:Oe(e)?e:document.scrollingElement}function ut(e,t){const n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),o=Number.parseFloat(window.getComputedStyle(t).borderTopWidth)||0,l=t.scrollTop;return n.top-r.top-o+l}function at(e){const{getScroller:t,root:n}=e,[r,o]=s.useState(0),[l,f]=s.useState(0),[u,d]=s.useState(0),[i,C]=s.useState(0),m=s.useRef(null);return s.useLayoutEffect(()=>{const c=t();if(c==null)return;let p;pe(c)?p=document.scrollingElement:p=c,m.current=p;const S=new ResizeObserver(M=>{const{width:g,height:y}=M[0].contentRect;o(g),f(y)});return S.observe(p),()=>{S.disconnect()}},[t]),s.useLayoutEffect(()=>{const c=n.current;if(c==null)return;const p=new ResizeObserver(S=>{const{width:M,height:g}=S[0].contentRect;d(M),C(g)});return p.observe(c),()=>{p.disconnect()}},[n]),{scrollContainerWidth:r,scrollContainerHeight:l,tableWidth:u,tableHeight:i}}const _e=s.createContext(null);function dt(e){const{getScroller:t,root:n,children:r}=e,{scrollContainerHeight:o,scrollContainerWidth:l,tableHeight:f,tableWidth:u}=at({getScroller:t,root:n}),d=s.useMemo(()=>({scrollContainerWidth:l,scrollContainerHeight:o,tableWidth:u,tableHeight:f}),[l,o,u,f]);return x.jsx(_e.Provider,{value:d,children:r})}function Ot(){const e=s.useContext(_e);if(e==null)throw new Error("useContainerSize provider not found");return e}const Ke=s.createContext(null);function ft(e){const{children:t}=e,n=s.useRef(new Map),r=s.useMemo(()=>{const o=new Set;return{listen(l,f){return n.current.set(l,(u,d)=>{f(u,d)}),()=>{n.current.delete(l)}},notify(l,f){if(o.has(l)){o.delete(l);return}const{scrollLeft:u,node:d}=f;let i=window.requestAnimationFrame;i==null&&(i=C=>{C()}),n.current.forEach((C,m)=>{l!==m&&(o.add(m),i(()=>{C(u(),d)}))})}}},[]);return x.jsx(Ke.Provider,{value:r,children:t})}function me(){const e=s.useContext(Ke);if(e==null)throw new Error("useHorizontalScrollContext provider not found");return e}const Pe=s.createContext(null);function Dt(){const e=s.useContext(Pe);if(e==null)throw new Error("useTableRowManager provider not found");return e}function xe(e,t){if(pe(e)){const n=()=>{t({width:window.innerWidth,height:window.innerHeight})};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}}else{const n=new ResizeObserver(r=>{const o=r[0].contentRect;t({width:o.width,height:o.height})});return n.observe(e),()=>{n.disconnect()}}}function ht(e,t){let n=0,r=e.length-1,o=-1;for(;n<=r;){const l=Math.floor((n+r)/2);e[l].bottom>t?(o=l,r=l-1):n=l+1}if(o!==-1)return e[o]}const be="NormalRow";function pt(e){const{getOffsetTop:t,rowKey:n,dataSource:r,getScroller:o,estimateSize:l,overscan:f}=e,[u,d]=s.useState(0),[i,C]=s.useState(0),m=s.useMemo(()=>r.slice(u,i),[r,u,i]),c=s.useRef(new Map),p=s.useCallback((h,R,w)=>{const a=c.current.get(h)??new Map;a.set(R,w),c.current.set(h,a)},[]),S=()=>{const h=[];return r.forEach(R=>{const w=fe(R,n),a=c.current.get(w);if(a==null)h.push(l);else{let T=0;a.forEach(k=>T+=k),h.push(T)}}),h};(()=>{if(r.length===0){c.current.clear();return}r.forEach(h=>{const R=fe(h,n),w=c.current.get(R)??new Map;w.get(be)==null&&w.set(be,l),c.current.set(R,w)})})();const g=s.useRef();(g.current==null||r.length!==g.current.length)&&(g.current=S());const y=s.useRef([]),j=()=>{const{rects:h}=r.reduce((R,w,a)=>{var L;const T=fe(w,n);let k=0;(L=c.current.get(T))==null||L.forEach(W=>{k+=W});const b=R.top+k;return R.rects.push({index:a,top:R.top,height:k,bottom:b}),R.top=b,R},{top:0,rects:[]});y.current=h},I=h=>{h==null||h(),j(),g.current=y.current.map(R=>R.height)},B=s.useRef({index:0,height:l,top:0,bottom:l}),_=s.useRef(0),O=s.useRef(!1);s.useEffect(()=>{const h=o();if(h==null)return;let R=0;const w=()=>{const W=t();let H=0;return pe(h)||De(h)?H=window.scrollY:H=Le(h).scrollTop,Math.max(H-W,0)},a=W=>{const H=R;return R=Math.ceil(W/l),{prevCount:H}},T=W=>{const H=ht(y.current,W);H!=null&&(B.current=H,d(Math.max(0,H.index-f)),C(H.index+R+f))},k=W=>{const H=t(),A=Le(W.target),V=Math.max(0,A.scrollTop-H);V>_.current?V>B.current.bottom&&T(V):V<B.current.top&&T(V),_.current=V};let b=0;const L=xe(h,W=>{if(W.height===b||W.height===0)return;b=W.height,a(W.height);const H=w();if(O.current)T(H);else{O.current=!0;let A=0;H>=l&&(A=Math.max(Math.floor(H/l)-1-f,0));const V=A+R+f;d(A),C(V)}});return h.addEventListener("scroll",k),()=>{L(),h.removeEventListener("scroll",k)}},[l,t,o,f]);const D=(h,R)=>g.current.slice(h,R).reduce((w,a)=>w+a,0),z=D(0,u),v=D(i);return console.log({topBlank:z,bottomBlank:v,startIndex:u,endIndex:i,rowHeightByRowKey:c.current,rowHeights:g.current,rowRects:y}),{startIndex:u,endIndex:i,rowHeightList:g,flushLayout:I,setRowHeightByRowKey:p,topBlank:z,bottomBlank:v,dataSlice:m}}function We(e){const t=s.useRef(null);return s.useLayoutEffect(()=>{t.current=e}),s.useCallback((...r)=>{var o;return(o=t.current)==null?void 0:o.call(t,...r)},[])}class mt{constructor(){de(this,"instance",{getCurrentProps(){throw new Error("getCurrentProps() has not been implemented yet")},getDOM(){throw new Error("getDOM() has not been implemented yet")},getScrollValueByRowIndex(){throw new Error("getScrollValueByRowIndex() has not been implemented yet")},getScrollValueByColumnKey(){throw new Error("getScrollValueByColumnKey() has not been implemented yet")},scrollToRow(){throw new Error("scrollToRow() has not been implemented yet")},scrollToColumn(){throw new Error("scrollToColumn() has not been implemented yet")},scrollTo(){throw new Error("scrollTo() has not been implemented yet")}});this.getInstance=this.getInstance.bind(this),this.getInternalHooks=this.getInternalHooks.bind(this)}getInternalHooks(){return{implGetCurrentProps:t=>{this.instance.getCurrentProps=t},implGetDOM:t=>{this.instance.getDOM=t},implScrollValueByRowIndex:t=>{this.instance.getScrollValueByRowIndex=t},implScrollValueByColumnKey:t=>{this.instance.getScrollValueByColumnKey=t},implScrollToRow:t=>{this.instance.scrollToRow=t},implScrollToColumn:t=>{this.instance.scrollToColumn=t},implScrollTo:t=>{this.instance.scrollTo=t}}}getInstance(){return{...Object.keys(this.instance).reduce((t,n)=>(t[n]=(...r)=>this.instance[n](...r),t),{}),getInternalHooks:this.getInternalHooks}}}function yt(e){return s.useMemo(()=>e??new mt().getInstance(),[e])}function gt(e){const t={current:null,options:null};return(...n)=>{const r=o=>e(o,...n);return ce(n,t.options)?t.current??r:(t.options=n,t.current=r,r)}}function wt(e){return Array.isArray(e)?e.filter(t=>t!=null&&(typeof t=="function"||typeof t.hook=="function")).map(t=>typeof t=="function"?{priority:100,hook:t}:t):[]}const he=class he{constructor(){de(this,"hooks",[]);this.use=this.use.bind(this)}setHooks(t){this.hooks=t}use(t){if(this.hooks.length===0)return t;const n={current:t},r={render:[],renderRoot:[],renderContent:[],renderHeaderWrapper:[],renderHeaderRoot:[],renderHeader:[],renderHeaderRow:[],renderHeaderCell:[],renderBodyWrapper:[],renderBodyRoot:[],renderBody:[],renderBodyContent:[],renderRow:[],renderCell:[]},o=[],l=[],f=this.hooks.slice();return f.sort((u,d)=>u.priority-d.priority),f.map(u=>u.hook).forEach(u=>{const d=u(n.current),{render:i,renderRoot:C,renderContent:m,renderHeaderWrapper:c,renderHeaderRoot:p,renderHeader:S,renderHeaderRow:M,renderHeaderCell:g,renderBodyWrapper:y,renderBodyRoot:j,renderBody:I,renderBodyContent:B,renderRow:_,renderCell:O,rowClassName:D,onRow:z,...v}=d;Object.entries(r).forEach(([h,R])=>{const w=d[h];typeof w=="function"&&R.push(w)}),typeof D=="function"&&o.push(D),typeof z=="function"&&l.push(z),n.current=v}),Object.entries(r).forEach(([u,d])=>{d.length>0&&(n.current[u]=(i,C)=>d.reduce((m,c)=>c(m,C),i))}),o.length>0&&(n.current.rowClassName=(u,d)=>q(...o.map(i=>i(u,d)))),l.length>0&&(n.current.onRow=(u,d)=>l.reduce((i,C)=>({...i,...C(u,d)}),{})),n.current}};de(he,"defaultPipeline",new he);let ie=he;function _t(e){const{use:t,pipeline:n}=e,r=s.useMemo(()=>({current:new ie}),[]);if(t!=null){const o=wt([...t,...(n==null?void 0:n.hooks)??[]]);if(!we(r.current.hooks,o)){const l=new ie;return l.setHooks(o),r.current=l,l}}return r.current}function Ce(e,t){let n=-1;for(let r=0;r<e.length;r+=1)t(e[r],r)&&(n=r);return n}function bt(e){const{className:t,rowKey:n,rowIndex:r,rowData:o,columns:l,onRow:f,renderRow:u,renderCell:d,onRefCallback:i,...C}=e,{columns:m,descriptor:c}=l,p=Ce(c,y=>y.type==="blank"?!1:G(y.column.fixed)),S=c.findIndex(y=>y.type==="blank"?!1:Q(y.column.fixed)),{className:M,...g}=(f==null?void 0:f(o,r))??{};return P(x.jsx("tr",{...C,...g,className:q("virtual-table-row",t,M),"data-row-index":r,ref:y=>{i==null||i({node:y,rowKey:n,rowIndex:r,rowData:o})},children:c.map((y,j)=>{const{key:I}=y;if(y.type==="blank")return x.jsx("td",{},I);const{column:B}=y;return x.jsx(ot,{className:q(p===j&&"virtual-table-cell-fix-left-last",S===j&&"virtual-table-cell-fix-right-first"),column:B,rowIndex:r,rowData:o,renderCell:d},I)})}),u,{columns:m,rowKey:n,rowIndex:r,rowData:o,columnDescriptor:c})}const Rt=s.memo(bt);function xt(e,t){typeof e=="function"?e(t):typeof e=="object"&&e!==null&&"current"in e&&(e.current=t)}function Ct(...e){return t=>{e.forEach(n=>xt(n,t))}}function re(...e){return s.useCallback(Ct(...e),e)}function St(e){const{bodyWrapperRef:t,bodyRootRef:n,bodyRef:r,className:o,style:l,dataSource:f,columns:u,rowKey:d,instance:i,overscan:C,estimateSize:m,getScroller:c,getOffsetTop:p,rowClassName:S,onRow:M,renderBodyWrapper:g,renderBodyRoot:y,renderBody:j,renderBodyContent:I,renderRow:B,renderCell:_}=e,{startIndex:O,dataSlice:D,setRowHeightByRowKey:z,flushLayout:v,rowHeightList:h,topBlank:R,bottomBlank:w}=pt({getOffsetTop:p,rowKey:d,dataSource:f,getScroller:c,estimateSize:m,overscan:C}),a=re(r,N=>{N==null||N.offsetHeight===0||v()}),T=s.useCallback(N=>{const{node:$,rowKey:K}=N;$!=null&&z(K,be,$.offsetHeight)},[z]),{columns:k,descriptor:b}=u,L=P(D.map((N,$)=>{const K=fe(N,d);return x.jsx(Rt,{className:q(S==null?void 0:S(N,$)),rowKey:K,rowIndex:$+O,rowData:N,columns:u,onRow:M,renderRow:B,renderCell:_,onRefCallback:T},K)}),I,{columns:k,columnDescriptor:b,startRowIndex:O}),W=P(x.jsx("tbody",{ref:a,children:L}),j,{columns:k,columnDescriptor:b,startRowIndex:O}),{setWidthList:H}=Re(),A=P(x.jsxs("table",{className:q(o,"virtual-table-body"),style:{...l,paddingBottom:w,paddingTop:R},ref:n,children:[x.jsx(Fe,{columns:b,onColumnSizesMeasure:H}),W]}),y,{columns:k,columnDescriptor:b,startRowIndex:O}),{listen:V,notify:oe}=me(),ue=s.useRef(null);s.useEffect(()=>{const N=ue.current;if(N==null)return;const $="virtual-table-body",K=()=>{oe($,{scrollLeft:()=>N.scrollLeft,node:N})},ne=V($,X=>{N.scrollLeft=X});return N.addEventListener("scroll",K),()=>{N.removeEventListener("scroll",K),ne()}},[V,oe]);const ye=re(ue,t),ae=i.getInternalHooks();ae.implScrollValueByRowIndex(N=>{if(c()==null)return 0;const{stickyHeader:K}=i.getCurrentProps(),{headerWrapper:ne}=i.getDOM();let X=0;return K==null||K===!1?X=ne==null?0:ne.offsetHeight:X=Number.isFinite(K)?K*-1:0,h.current.slice(0,N).reduce((J,Z)=>J+Z,0)+p()+X}),ae.implScrollToRow(N=>{i.scrollTo({top:i.getScrollValueByRowIndex(N)})});const ge=s.useMemo(()=>({setRowHeightByRowKey:z,getRowHeightList:()=>h.current}),[h,z]);return x.jsx(Pe.Provider,{value:ge,children:P(x.jsx("div",{ref:ye,className:"virtual-table-body-wrapper",children:A}),g,{columns:k,columnDescriptor:b,startRowIndex:O})})}const kt=e=>{const{className:t,style:n,wrapperRef:r,columns:o,stickyHeader:l,renderHeaderWrapper:f,renderHeaderRoot:u,renderHeader:d,renderHeaderRow:i,renderHeaderCell:C}=e,{columns:m,descriptor:c}=o,p=m[m.length-1],{widthList:S}=Re(),{size:M}=ze(),g=Ce(c,v=>v.type==="blank"?!1:G(v.column.fixed)),y=c.findIndex(v=>v.type==="blank"?!1:Q(v.column.fixed)),{listen:j,notify:I}=me(),B=s.useRef(null);s.useEffect(()=>{const v=B.current;if(v==null)return;const h="virtual-table-header",R=()=>{I(h,{scrollLeft:()=>v.scrollLeft,node:v})},w=j(h,a=>{v.scrollLeft=a});return v.addEventListener("scroll",R),()=>{v.removeEventListener("scroll",R),w()}},[j,I]);const _=P(x.jsx("tr",{children:c.map((v,h)=>{var L;const{key:R}=v;if(v.type==="blank")return x.jsx("th",{"data-blank":!0},R);const{column:w}=v;if(w.colSpan===0)return null;const a=Y(p)===R,{className:T,style:k,...b}=((L=w.onHeaderCell)==null?void 0:L.call(w,w,h))??{};return x.jsx(s.Fragment,{children:P(s.createElement("th",{scope:"col",...b,colSpan:w.colSpan,className:q("virtual-table-header-cell",a&&"no-split",w.align!=null&&`virtual-table-align-${w.align}`,je(w.fixed)&&"virtual-table-sticky-cell",g===h&&"virtual-table-cell-fix-left-last",y===h&&"virtual-table-cell-fix-right-first",w.className,T),style:{...k,left:G(w.fixed)?M.get(R):void 0,right:Q(w.fixed)?M.get(R):void 0}},w.title),C,{column:w,columns:m,columnWidths:S,columnDescriptor:c})},R)})}),i,{columns:m,columnDescriptor:c}),O=P(x.jsx("thead",{className:"virtual-table-thead",children:_}),d,{columns:m,columnDescriptor:c}),D=P(x.jsxs("table",{style:n,children:[x.jsx(Fe,{columns:c}),O]}),u,{columns:m,columnDescriptor:c}),z=re(r,B);return P(x.jsx("div",{ref:z,className:q("virtual-table-header",t,{"virtual-table-header-sticky":l}),style:{top:Number.isFinite(l)?l:void 0},children:D}),f,{columns:m,columnDescriptor:c})},vt=s.memo(kt);function Ht(e,t){let n=0,r=e.length-1,o=-1;for(;n<=r;){const l=Math.floor((n+r)/2);e[l].right>t?(o=l,r=l-1):n=l+1}if(o!==-1)return e[o]}function Et(e){let t=-1;for(let n=e.length-1;n>=0;n--){const r=e[n];if(Q(r.fixed))t=n;else break}return t}function Mt(e){return Ce(e,t=>G(t.fixed))}function Tt(e){const{estimateSize:t,defaultColumnWidth:n,overscan:r,columns:o,bodyWrapper:l,columnWidths:f,disabled:u=!1}=e,d=Mt(o),i=Et(o),C=d>-1?Y(o[d]):null,m=i>-1?Y(o[i]):null,[c,p]=s.useState(0),[S,M]=s.useState(0),g=s.useMemo(()=>{if(u)return[];let a=0;return o.map((T,k)=>{const b=Y(T),L=f.get(b)??t,W=a+L,H={index:k,width:L,left:a,right:W};return a=W,H})},[o,f,t,u]),y=s.useRef({index:0,width:t,left:0,right:t}),j=We(a=>Ht(g,a)),I=We((a,T)=>{const k=j(a);k!=null&&(y.current=k,p(Math.max(0,k.index-r)),M(k.index+T+r))}),B=s.useRef(0);s.useEffect(()=>{if(u)return;const a=l.current;if(a==null)return;const T=a.offsetWidth;let k=Math.ceil(T/t);const b=()=>{const H=a.scrollLeft;H>B.current?H>y.current.right&&I(H,k):H<y.current.left&&I(H,k),B.current=H};a.addEventListener("scroll",b);let L=0;const W=xe(a,({width:H})=>{if(H===L||H===0)return;L=H;const A=a.scrollLeft;k=Math.ceil(H/t),I(A,k)});return()=>{a.removeEventListener("scroll",b),W()}},[l,t,I,r,j,u]);const _=(a,T)=>g.slice(a,T).reduce((k,b)=>k+b.width,0),O=d>-1?_(0,d+1):0,D=i>-1?_(i):0,z=Math.max(0,_(0,c)-O),v=Math.max(0,_(S)-D),h=s.useMemo(()=>{if(u)return o;const a=[...o.slice(0,d+1),...o.slice(c,S),...o.slice(i)],T=new Set;return a.filter(k=>{const b=Y(k);return T.has(b)?!1:(T.add(b),!0)})},[u,o,c,S,d,i]),R=s.useMemo(()=>h.reduce((a,T,k)=>{const b=Y(T);let L=T;return L.width==null&&L.minWidth==null&&(L={...L,width:n}),b===C?(a.push({type:"normal",key:b,column:L}),a.push({type:"blank",key:"_blank_left",width:z})):C==null&&k===0?(a.push({type:"blank",key:"_blank_left",width:z}),a.push({type:"normal",key:b,column:L})):b===m?(a.push({type:"blank",key:"_blank_right",width:v}),a.push({type:"normal",key:b,column:L})):m==null&&k===h.length-1?(a.push({type:"normal",key:b,column:L}),a.push({type:"blank",key:"_blank_right",width:v})):a.push({type:"normal",key:b,column:L}),a},[]),[h,C,m,z,v,n]);return{columns:s.useMemo(()=>({columns:h,descriptor:R}),[h,R]),columnSlice:h,lastFixedLeftIndex:d,firstFixedRightIndex:i}}function Lt(e,t){const{className:n,style:r,children:o,hasFixedLeftColumn:l,hasFixedRightColumn:f,renderRoot:u,bodyScrollContainer:d}=e,i=s.useRef(null),[C,m]=s.useState(!1),[c,p]=s.useState(!1),{listen:S}=me();s.useEffect(()=>{if(!l&&!f)return;const g=j=>{const{scrollLeft:I,clientWidth:B,scrollWidth:_}=j;l&&m(I!==0),f&&p(!(I+B>=_))},y=d.current;return y!=null&&g(y),S("__root",(j,I)=>{g(I)})},[d,l,f,S]);const M=re(t,i);return P(x.jsx("div",{ref:M,className:q("virtual-table",C&&"virtual-table-has-fix-left",c&&"virtual-table-has-fix-right",n),style:r,children:o}),u,{})}const Wt=s.forwardRef(Lt);function It(e,t){const{bodyRootRef:n,instance:r,className:o,style:l,tableBodyClassName:f,tableBodyStyle:u,columns:d,dataSource:i,rowKey:C="key",estimatedRowHeight:m=46,estimatedColumnWidth:c,overscanRows:p=5,overscanColumns:S=3,stickyHeader:M,defaultColumnWidth:g=100,pipeline:y=ie.defaultPipeline,rowClassName:j,onRow:I,getOffsetTop:B,virtualHeader:_=!0}=e,O=yt(r),D=s.useRef(null),z=s.useRef(null),v=s.useRef(null),h=s.useRef(null),R=re(h,n),w=s.useRef(null),a=s.useCallback(()=>{const E=D.current;if(E!=null)return ct(E)},[]),T=s.useCallback(()=>{if(typeof B=="function")return B();const E=a(),F=D.current;if(F==null||E==null||E===F)return 0;if(pe(E)||De(E)){const U=F.getBoundingClientRect().top;return window.scrollY+U}return ut(F,E)},[B,a]),{dataSource:k,columns:b,rowKey:L,rowClassName:W,render:H,renderRoot:A,renderContent:V,renderHeaderWrapper:oe,renderHeaderRoot:ue,renderHeader:ye,renderHeaderRow:ae,renderHeaderCell:ge,renderBodyWrapper:N,renderBodyRoot:$,renderBody:K,renderBodyContent:ne,renderRow:X,renderCell:Se,onRow:J}=y.use({dataSource:i,rowKey:C,columns:d,estimatedRowHeight:m,headerWrapperRef:z,bodyWrapperRef:v,bodyRootRef:h,bodyRef:w,rootRef:D,getOffsetTop:T,getScroller:a,instance:O}),[Z,Ae]=s.useState(()=>new Map),ke=s.useRef(Z),ve=s.useCallback(E=>{const F=new Map(ke.current);E.forEach((U,te)=>{F.set(te,U)}),ke.current=F,Ae(F)},[]),Ve=s.useMemo(()=>({widthList:Z,setWidthList:ve}),[Z,ve]),{columns:ee}=Tt({estimateSize:c??g,defaultColumnWidth:g,overscan:S,columns:b,bodyWrapper:v,columnWidths:Z,disabled:c==null}),$e=s.useCallback((E,F)=>q(j==null?void 0:j(E,F),W==null?void 0:W(E,F)),[j,W]),qe=s.useCallback((E,F)=>({...I==null?void 0:I(E,F),...J==null?void 0:J(E,F)}),[J,I]),Ye=b.some(E=>G(E.fixed)),Ge=b.some(E=>Q(E.fixed)),He=s.useMemo(()=>({columns:b,descriptor:b.map(E=>({key:Y(E),type:"normal",column:E}))}),[b]),Qe=s.useMemo(()=>_?ee:He,[_,He,ee]),se=O.getInternalHooks();se.implGetCurrentProps(()=>e),se.implGetDOM(()=>({root:D.current,headerWrapper:z.current,bodyWrapper:v.current,bodyRoot:h.current,body:w.current})),se.implScrollTo(E=>{var te;const{left:F,top:U}=E;if(F!=null&&((te=v.current)==null||te.scrollTo(E)),U!=null){const le=a();if(le==null){console.error("The scroller DOM is not obtained, and scrolling is not possible.");return}le.scrollTo(E)}}),se.implScrollValueByColumnKey(E=>{let F=0,U=0;for(const te of b){const le=Y(te),Ee=Z.get(le)??0;if(G(te.fixed)&&(U+=Ee),le===E)break;F+=Ee}return F-U}),se.implScrollToColumn(E=>{O.scrollTo({left:O.getScrollValueByColumnKey(E)})});const Ue=P(x.jsxs(x.Fragment,{children:[x.jsx(vt,{wrapperRef:z,columns:Qe,stickyHeader:M,renderHeaderWrapper:oe,renderHeaderRoot:ue,renderHeader:ye,renderHeaderRow:ae,renderHeaderCell:ge}),x.jsx(St,{instance:O,bodyWrapperRef:v,bodyRootRef:R,bodyRef:w,className:f,style:u,columns:ee,rowKey:L,dataSource:k,overscan:p,estimateSize:m,getScroller:a,getOffsetTop:T,rowClassName:$e,onRow:qe,renderBodyWrapper:N,renderBodyRoot:$,renderBody:K,renderBodyContent:ne,renderRow:X,renderCell:Se})]}),V,{columns:ee.columns,columnDescriptor:ee.descriptor}),Xe=re(D,t),Je=P(x.jsx(Wt,{ref:Xe,className:o,style:l,hasFixedLeftColumn:Ye,hasFixedRightColumn:Ge,renderRoot:A,bodyScrollContainer:v,children:Ue}),H,{columns:ee.columns,columnDescriptor:ee.descriptor});return x.jsx(Ne.Provider,{value:Ve,children:x.jsx(tt,{columns:b,children:x.jsx(dt,{getScroller:a,root:D,children:x.jsx(ft,{children:Je})})})})}const Kt=s.memo(s.forwardRef(It));function jt(){const e=document.createElement("div");e.style.position="absolute",e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.top="-9999px",document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth,n=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),{width:t,height:n}}const Nt=e=>{const{className:t,style:n,bottom:r,zIndex:o,bodyRef:l}=e,{listen:f,notify:u}=me(),d=s.useRef(null);s.useEffect(()=>{const c=d.current;if(c==null)return;const p="virtual-table-sticky-bottom-scroll",S=()=>{u(p,{scrollLeft:()=>c.scrollLeft,node:c})},M=f(p,g=>{c.scrollLeft=g});return c.addEventListener("scroll",S),()=>{c.removeEventListener("scroll",S),M()}},[f,u]);const[i,C]=s.useState(0);s.useEffect(()=>{const c=l.current;if(c!=null)return xe(c,({width:p})=>{p!==0&&C(p)})},[l]);const[m]=s.useState(jt);return x.jsx("div",{className:q("virtual-table-sticky-scroll",t),style:{...n,"--virtual-table-sticky-scroll-bottom":Number.isFinite(r)?`${r}px`:r,paddingTop:m.height>0?0:15,marginTop:m.height>0?0:m.height*-1,height:m.height+1,zIndex:o},ref:d,children:x.jsx("div",{className:"virtual-table-sticky-scroll-bar",style:{width:i}})})};function Bt(e,t){const{bodyRootRef:n}=e;return{...e,renderContent(r){return x.jsxs(x.Fragment,{children:[r,x.jsx(Nt,{bodyRef:n,...t})]})}}}const Pt=gt(Bt);export{Fe as C,Kt as V,yt as a,gt as b,q as c,Ot as d,Dt as e,Te as f,Y as g,Pt as h,We as i,je as j,fe as k,ze as l,Q as m,G as n,Ce as o,xe as p,me as q,jt as r,re as s,_t as u};

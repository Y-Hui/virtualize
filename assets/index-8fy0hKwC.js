var Ze=Object.defineProperty;var et=(e,t,n)=>t in e?Ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var de=(e,t,n)=>et(e,typeof t!="symbol"?t+"":t,n);import{r as s,j as R}from"./index-CvZAtKUh.js";function Ie(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=Ie(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function q(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=Ie(e))&&(r&&(r+=" "),r+=t);return r}function Me(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=Object.keys(e),r=Object.keys(t),o=n.length;if(r.length!==o)return!1;for(let l=0;l<o;l+=1){const f=n[l];if(e[f]!==t[f]||!Object.prototype.hasOwnProperty.call(t,f))return!1}return!0}function we(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=e.length;if(t.length!==n)return!1;for(let r=0;r<n;r+=1)if(e[r]!==t[r])return!1;return!0}function ce(e,t){if(Object.is(e,t))return!0;if(Array.isArray(e)&&Array.isArray(t))return we(e,t)?!0:e.length===t.length&&e.findIndex(r=>typeof r=="object"&&r!=null)>-1?e.every((r,o)=>Array.isArray(r)?we(r,t[o]):typeof r=="object"&&r!=null?Me(r,t[o]):Object.is(r,t[o])):!1;if(e instanceof Map&&t instanceof Map){const n=Array.from(e.keys()),r=Array.from(t.keys());if(ce(n,r)){const o=Array.from(e.values()),l=Array.from(t.values());if(ce(o,l))return!0}return!1}return typeof e=="object"&&e!=null?Me(e,t):!1}function Te(e){const t=e(),n=s.useRef(t);return ce(t,n.current)||(n.current=t),n.current}function Y(e){return"key"in e?e.key:e.dataIndex}function fe(e,t){return typeof t=="function"?t(e):e[t]}function G(e){return e==="left"}function Q(e){return e==="right"}function je(e){return G(e)||Q(e)}const Ne=s.createContext(null);function Re(){const e=s.useContext(Ne);if(e==null)throw new Error("useColumnSizes provider not found");return e}const Be=s.createContext(null);function tt(e){const{columns:t,children:n}=e,{widthList:r}=Re(),o=s.useMemo(()=>t.map(i=>({key:Y(i),fixed:i.fixed})),[t]),l=s.useMemo(()=>{let i=0;const C=o.reduce((p,S,M)=>{const{fixed:b,key:w}=S;return G(b)&&(p[M]=i,i+=r.get(w)??0),p},[]);let m=0;const c=o.reduceRight((p,S,M)=>{const{fixed:b,key:w}=S;return Q(b)&&(p[M]=m,m+=r.get(w)??0),p},[]);return o.reduce((p,S,M)=>{const{key:b,fixed:w}=S;return G(w)?(p.set(b,C[M]),p):(Q(w)&&p.set(b,c[M]),p)},new Map)},[o,r]),f=Te(()=>o),a=Te(()=>l),d=s.useMemo(()=>({size:a,fixed:f}),[f,a]);return R.jsx(Be.Provider,{value:d,children:n})}function ze(){const e=s.useContext(Be);if(e==null)throw new Error("useTableSticky provider not found");return e}function P(e,t,n){return typeof t=="function"?t(e,n):e}function nt(e,t,n){const{render:r}=n,o=t;if("dataIndex"in n){const l=n.dataIndex;return typeof r!="function"?o[l]:r(o[l],t,e)}return(r==null?void 0:r(t,t,e))??null}function rt(e){const{className:t,style:n,column:r,rowData:o,rowIndex:l,renderCell:f,...a}=e,{align:d,fixed:i,onCell:C}=r,m=Y(r),{size:c}=ze(),{className:p,style:S,colSpan:M,rowSpan:b,...w}=(C==null?void 0:C(o,l))??{};return M===0||b===0?null:P(R.jsx("td",{...a,...w,colSpan:M,rowSpan:b,className:q("virtual-table-cell",d!=null&&`virtual-table-align-${d}`,je(i)&&"virtual-table-sticky-cell",t,r.className,p),style:{...n,...S,left:G(i)?c.get(m):void 0,right:Q(i)?c.get(m):void 0},"data-col-key":m,children:nt(l,o,r)}),f,{column:r})}const ot=s.memo(rt),st=e=>{const{columns:t,onColumnSizesMeasure:n}=e,r=n!=null,o=new Map,l=s.useRef(new Map);return R.jsx("colgroup",{ref:()=>{r&&(ce(o,l.current)||(n(o),l.current=o))},children:t.map(f=>{const{key:a}=f;if(f.type==="blank")return R.jsx("col",{className:"blank",style:{width:f.width}},a);const{column:d}=f;return R.jsx("col",{ref:i=>{i==null||!r||o.set(a,i.offsetWidth)},style:{width:d.width,minWidth:d.minWidth}},a)})})},Fe=s.memo(st),lt=/auto|scroll|overlay|hidden/;function Oe(e){return e instanceof Node?e.nodeType===1:!1}function ct(e,t=window){let n=e;for(;n!==t&&Oe(n);){if(n===document.body)return t;const{overflow:r,overflowY:o,overflowX:l}=window.getComputedStyle(n);if(lt.test(r+o+l))return n;n=n.parentNode}return e.ownerDocument.defaultView??window}function pe(e){return Object.prototype.toString.call(e)==="[object Window]"}function it(e){return Object.prototype.toString.call(e)==="[object HTMLDocument]"}function De(e){return Object.prototype.toString.call(e)==="[object HTMLHtmlElement]"}function Le(e){return it(e)?e.scrollingElement:Oe(e)?e:document.scrollingElement}function ut(e,t){const n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),o=Number.parseFloat(window.getComputedStyle(t).borderTopWidth)||0,l=t.scrollTop;return n.top-r.top-o+l}function at(e){const{getScroller:t,root:n}=e,[r,o]=s.useState(0),[l,f]=s.useState(0),[a,d]=s.useState(0),[i,C]=s.useState(0),m=s.useRef(null);return s.useLayoutEffect(()=>{const c=t();if(c==null)return;let p;pe(c)?p=document.scrollingElement:p=c,m.current=p;const S=new ResizeObserver(M=>{const{width:b,height:w}=M[0].contentRect;o(b),f(w)});return S.observe(p),()=>{S.disconnect()}},[t]),s.useLayoutEffect(()=>{const c=n.current;if(c==null)return;const p=new ResizeObserver(S=>{const{width:M,height:b}=S[0].contentRect;d(M),C(b)});return p.observe(c),()=>{p.disconnect()}},[n]),{scrollContainerWidth:r,scrollContainerHeight:l,tableWidth:a,tableHeight:i}}const _e=s.createContext(null);function dt(e){const{getScroller:t,root:n,children:r}=e,{scrollContainerHeight:o,scrollContainerWidth:l,tableHeight:f,tableWidth:a}=at({getScroller:t,root:n}),d=s.useMemo(()=>({scrollContainerWidth:l,scrollContainerHeight:o,tableWidth:a,tableHeight:f}),[l,o,a,f]);return R.jsx(_e.Provider,{value:d,children:r})}function Ot(){const e=s.useContext(_e);if(e==null)throw new Error("useContainerSize provider not found");return e}const Ke=s.createContext(null);function ft(e){const{children:t}=e,n=s.useRef(new Map),r=s.useMemo(()=>{const o=new Set;return{listen(l,f){return n.current.set(l,(a,d)=>{f(a,d)}),()=>{n.current.delete(l)}},notify(l,f){if(o.has(l)){o.delete(l);return}const{scrollLeft:a,node:d}=f;let i=window.requestAnimationFrame;i==null&&(i=C=>{C()}),n.current.forEach((C,m)=>{l!==m&&(o.add(m),i(()=>{C(a(),d)}))})}}},[]);return R.jsx(Ke.Provider,{value:r,children:t})}function me(){const e=s.useContext(Ke);if(e==null)throw new Error("useHorizontalScrollContext provider not found");return e}const Pe=s.createContext(null);function Dt(){const e=s.useContext(Pe);if(e==null)throw new Error("useTableRowManager provider not found");return e}function xe(e,t){if(pe(e)){const n=()=>{t({width:window.innerWidth,height:window.innerHeight})};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}}else{const n=new ResizeObserver(r=>{const o=r[0].contentRect;t({width:o.width,height:o.height})});return n.observe(e),()=>{n.disconnect()}}}function ht(e,t){let n=0,r=e.length-1,o=-1;for(;n<=r;){const l=Math.floor((n+r)/2);e[l].bottom>t?(o=l,r=l-1):n=l+1}if(o!==-1)return e[o]}const be="NormalRow";function pt(e){const{getOffsetTop:t,rowKey:n,dataSource:r,getScroller:o,estimateSize:l,overscan:f}=e,[a,d]=s.useState(0),[i,C]=s.useState(0),m=s.useMemo(()=>r.slice(a,i),[r,a,i]),c=s.useRef(new Map),p=s.useCallback((h,x,y)=>{const u=c.current.get(h)??new Map;u.set(x,y),c.current.set(h,u)},[]),S=()=>{const h=[];return r.forEach(x=>{const y=fe(x,n),u=c.current.get(y);if(u==null)h.push(l);else{let T=0;u.forEach(k=>T+=k),h.push(T)}}),h};(()=>{if(r.length===0){c.current.clear();return}r.forEach(h=>{const x=fe(h,n),y=c.current.get(x)??new Map;y.get(be)==null&&y.set(be,l),c.current.set(x,y)})})();const b=s.useRef();(b.current==null||r.length!==b.current.length)&&(b.current=S());const w=s.useRef([]),j=()=>{const{rects:h}=r.reduce((x,y,u)=>{var L;const T=fe(y,n);let k=0;(L=c.current.get(T))==null||L.forEach(W=>{k+=W});const g=x.top+k;return x.rects.push({index:u,top:x.top,height:k,bottom:g}),x.top=g,x},{top:0,rects:[]});w.current=h},I=h=>{h==null||h(),j()},B=s.useRef({index:0,height:l,top:0,bottom:l}),_=s.useRef(0),F=s.useRef(!1);s.useEffect(()=>{const h=o();if(h==null)return;let x=0;const y=()=>{const W=t();let v=0;return pe(h)||De(h)?v=window.scrollY:v=Le(h).scrollTop,Math.max(v-W,0)},u=W=>{const v=x;return x=Math.ceil(W/l),{prevCount:v}},T=W=>{const v=ht(w.current,W);v!=null&&(B.current=v,d(Math.max(0,v.index-f)),C(v.index+x+f))},k=W=>{const v=t(),A=Le(W.target),V=Math.max(0,A.scrollTop-v);V>_.current?V>B.current.bottom&&T(V):V<B.current.top&&T(V),_.current=V};let g=0;const L=xe(h,W=>{if(W.height===g||W.height===0)return;g=W.height,u(W.height);const v=y();if(F.current)T(v);else{F.current=!0;let A=0;v>=l&&(A=Math.max(Math.floor(v/l)-1-f,0));const V=A+x+f;d(A),C(V)}});return h.addEventListener("scroll",k),()=>{L(),h.removeEventListener("scroll",k)}},[l,t,o,f]);const D=(h,x)=>b.current.slice(h,x).reduce((y,u)=>y+u,0),O=D(0,a),H=D(i);return{startIndex:a,endIndex:i,rowHeightList:b,flushLayout:I,setRowHeightByRowKey:p,topBlank:O,bottomBlank:H,dataSlice:m}}function We(e){const t=s.useRef(null);return s.useLayoutEffect(()=>{t.current=e}),s.useCallback((...r)=>{var o;return(o=t.current)==null?void 0:o.call(t,...r)},[])}class mt{constructor(){de(this,"instance",{getCurrentProps(){throw new Error("getCurrentProps() has not been implemented yet")},getDOM(){throw new Error("getDOM() has not been implemented yet")},getScrollValueByRowIndex(){throw new Error("getScrollValueByRowIndex() has not been implemented yet")},getScrollValueByColumnKey(){throw new Error("getScrollValueByColumnKey() has not been implemented yet")},scrollToRow(){throw new Error("scrollToRow() has not been implemented yet")},scrollToColumn(){throw new Error("scrollToColumn() has not been implemented yet")},scrollTo(){throw new Error("scrollTo() has not been implemented yet")}});this.getInstance=this.getInstance.bind(this),this.getInternalHooks=this.getInternalHooks.bind(this)}getInternalHooks(){return{implGetCurrentProps:t=>{this.instance.getCurrentProps=t},implGetDOM:t=>{this.instance.getDOM=t},implScrollValueByRowIndex:t=>{this.instance.getScrollValueByRowIndex=t},implScrollValueByColumnKey:t=>{this.instance.getScrollValueByColumnKey=t},implScrollToRow:t=>{this.instance.scrollToRow=t},implScrollToColumn:t=>{this.instance.scrollToColumn=t},implScrollTo:t=>{this.instance.scrollTo=t}}}getInstance(){return{...Object.keys(this.instance).reduce((t,n)=>(t[n]=(...r)=>this.instance[n](...r),t),{}),getInternalHooks:this.getInternalHooks}}}function yt(e){return s.useMemo(()=>e??new mt().getInstance(),[e])}function gt(e){const t={current:null,options:null};return(...n)=>{const r=o=>e(o,...n);return ce(n,t.options)?t.current??r:(t.options=n,t.current=r,r)}}function wt(e){return Array.isArray(e)?e.filter(t=>t!=null&&(typeof t=="function"||typeof t.hook=="function")).map(t=>typeof t=="function"?{priority:100,hook:t}:t):[]}const he=class he{constructor(){de(this,"hooks",[]);this.use=this.use.bind(this)}setHooks(t){this.hooks=t}use(t){if(this.hooks.length===0)return t;const n={current:t},r={render:[],renderRoot:[],renderContent:[],renderHeaderWrapper:[],renderHeaderRoot:[],renderHeader:[],renderHeaderRow:[],renderHeaderCell:[],renderBodyWrapper:[],renderBodyRoot:[],renderBody:[],renderBodyContent:[],renderRow:[],renderCell:[]},o=[],l=[],f=this.hooks.slice();return f.sort((a,d)=>a.priority-d.priority),f.map(a=>a.hook).forEach(a=>{const d=a(n.current),{render:i,renderRoot:C,renderContent:m,renderHeaderWrapper:c,renderHeaderRoot:p,renderHeader:S,renderHeaderRow:M,renderHeaderCell:b,renderBodyWrapper:w,renderBodyRoot:j,renderBody:I,renderBodyContent:B,renderRow:_,renderCell:F,rowClassName:D,onRow:O,...H}=d;Object.entries(r).forEach(([h,x])=>{const y=d[h];typeof y=="function"&&x.push(y)}),typeof D=="function"&&o.push(D),typeof O=="function"&&l.push(O),n.current=H}),Object.entries(r).forEach(([a,d])=>{d.length>0&&(n.current[a]=(i,C)=>d.reduce((m,c)=>c(m,C),i))}),o.length>0&&(n.current.rowClassName=(a,d)=>q(...o.map(i=>i(a,d)))),l.length>0&&(n.current.onRow=(a,d)=>l.reduce((i,C)=>({...i,...C(a,d)}),{})),n.current}};de(he,"defaultPipeline",new he);let ie=he;function _t(e){const{use:t,pipeline:n}=e,r=s.useMemo(()=>({current:new ie}),[]);if(t!=null){const o=wt([...t,...(n==null?void 0:n.hooks)??[]]);if(!we(r.current.hooks,o)){const l=new ie;return l.setHooks(o),r.current=l,l}}return r.current}function Ce(e,t){let n=-1;for(let r=0;r<e.length;r+=1)t(e[r],r)&&(n=r);return n}function bt(e){const{className:t,rowKey:n,rowIndex:r,rowData:o,columns:l,onRow:f,renderRow:a,renderCell:d,onRefCallback:i,...C}=e,{columns:m,descriptor:c}=l,p=Ce(c,w=>w.type==="blank"?!1:G(w.column.fixed)),S=c.findIndex(w=>w.type==="blank"?!1:Q(w.column.fixed)),{className:M,...b}=(f==null?void 0:f(o,r))??{};return P(R.jsx("tr",{...C,...b,className:q("virtual-table-row",t,M),"data-row-index":r,ref:w=>{i==null||i({node:w,rowKey:n,rowIndex:r,rowData:o})},children:c.map((w,j)=>{const{key:I}=w;if(w.type==="blank")return R.jsx("td",{},I);const{column:B}=w;return R.jsx(ot,{className:q(p===j&&"virtual-table-cell-fix-left-last",S===j&&"virtual-table-cell-fix-right-first"),column:B,rowIndex:r,rowData:o,renderCell:d},I)})}),a,{columns:m,rowKey:n,rowIndex:r,rowData:o,columnDescriptor:c})}const Rt=s.memo(bt);function xt(e,t){typeof e=="function"?e(t):typeof e=="object"&&e!==null&&"current"in e&&(e.current=t)}function Ct(...e){return t=>{e.forEach(n=>xt(n,t))}}function re(...e){return s.useCallback(Ct(...e),e)}function St(e){const{bodyWrapperRef:t,bodyRootRef:n,bodyRef:r,className:o,style:l,dataSource:f,columns:a,rowKey:d,instance:i,overscan:C,estimateSize:m,getScroller:c,getOffsetTop:p,rowClassName:S,onRow:M,renderBodyWrapper:b,renderBodyRoot:w,renderBody:j,renderBodyContent:I,renderRow:B,renderCell:_}=e,{startIndex:F,dataSlice:D,setRowHeightByRowKey:O,flushLayout:H,rowHeightList:h,topBlank:x,bottomBlank:y}=pt({getOffsetTop:p,rowKey:d,dataSource:f,getScroller:c,estimateSize:m,overscan:C}),u=re(r,N=>{N==null||N.offsetHeight===0||H()}),T=s.useCallback(N=>{const{node:$,rowKey:K}=N;$!=null&&O(K,be,$.offsetHeight)},[O]),{columns:k,descriptor:g}=a,L=P(D.map((N,$)=>{const K=fe(N,d);return R.jsx(Rt,{className:q(S==null?void 0:S(N,$)),rowKey:K,rowIndex:$+F,rowData:N,columns:a,onRow:M,renderRow:B,renderCell:_,onRefCallback:T},K)}),I,{columns:k,columnDescriptor:g,startRowIndex:F}),W=P(R.jsx("tbody",{ref:u,children:L}),j,{columns:k,columnDescriptor:g,startRowIndex:F}),{setWidthList:v}=Re(),A=P(R.jsxs("table",{className:q(o,"virtual-table-body"),style:{...l,paddingBottom:y,paddingTop:x},ref:n,children:[R.jsx(Fe,{columns:g,onColumnSizesMeasure:v}),W]}),w,{columns:k,columnDescriptor:g,startRowIndex:F}),{listen:V,notify:oe}=me(),ue=s.useRef(null);s.useEffect(()=>{const N=ue.current;if(N==null)return;const $="virtual-table-body",K=()=>{oe($,{scrollLeft:()=>N.scrollLeft,node:N})},ne=V($,X=>{N.scrollLeft=X});return N.addEventListener("scroll",K),()=>{N.removeEventListener("scroll",K),ne()}},[V,oe]);const ye=re(ue,t),ae=i.getInternalHooks();ae.implScrollValueByRowIndex(N=>{if(c()==null)return 0;const{stickyHeader:K}=i.getCurrentProps(),{headerWrapper:ne}=i.getDOM();let X=0;return K==null||K===!1?X=ne==null?0:ne.offsetHeight:X=Number.isFinite(K)?K*-1:0,h.current.slice(0,N).reduce((J,Z)=>J+Z,0)+p()+X}),ae.implScrollToRow(N=>{i.scrollTo({top:i.getScrollValueByRowIndex(N)})});const ge=s.useMemo(()=>({setRowHeightByRowKey:O,getRowHeightList:()=>h.current}),[h,O]);return R.jsx(Pe.Provider,{value:ge,children:P(R.jsx("div",{ref:ye,className:"virtual-table-body-wrapper",children:A}),b,{columns:k,columnDescriptor:g,startRowIndex:F})})}const kt=e=>{const{className:t,style:n,wrapperRef:r,columns:o,stickyHeader:l,renderHeaderWrapper:f,renderHeaderRoot:a,renderHeader:d,renderHeaderRow:i,renderHeaderCell:C}=e,{columns:m,descriptor:c}=o,p=m[m.length-1],{widthList:S}=Re(),{size:M}=ze(),b=Ce(c,H=>H.type==="blank"?!1:G(H.column.fixed)),w=c.findIndex(H=>H.type==="blank"?!1:Q(H.column.fixed)),{listen:j,notify:I}=me(),B=s.useRef(null);s.useEffect(()=>{const H=B.current;if(H==null)return;const h="virtual-table-header",x=()=>{I(h,{scrollLeft:()=>H.scrollLeft,node:H})},y=j(h,u=>{H.scrollLeft=u});return H.addEventListener("scroll",x),()=>{H.removeEventListener("scroll",x),y()}},[j,I]);const _=P(R.jsx("tr",{children:c.map((H,h)=>{var L;const{key:x}=H;if(H.type==="blank")return R.jsx("th",{"data-blank":!0},x);const{column:y}=H;if(y.colSpan===0)return null;const u=Y(p)===x,{className:T,style:k,...g}=((L=y.onHeaderCell)==null?void 0:L.call(y,y,h))??{};return R.jsx(s.Fragment,{children:P(s.createElement("th",{scope:"col",...g,colSpan:y.colSpan,className:q("virtual-table-header-cell",u&&"no-split",y.align!=null&&`virtual-table-align-${y.align}`,je(y.fixed)&&"virtual-table-sticky-cell",b===h&&"virtual-table-cell-fix-left-last",w===h&&"virtual-table-cell-fix-right-first",y.className,T),style:{...k,left:G(y.fixed)?M.get(x):void 0,right:Q(y.fixed)?M.get(x):void 0}},y.title),C,{column:y,columns:m,columnWidths:S,columnDescriptor:c})},x)})}),i,{columns:m,columnDescriptor:c}),F=P(R.jsx("thead",{className:"virtual-table-thead",children:_}),d,{columns:m,columnDescriptor:c}),D=P(R.jsxs("table",{style:n,children:[R.jsx(Fe,{columns:c}),F]}),a,{columns:m,columnDescriptor:c}),O=re(r,B);return P(R.jsx("div",{ref:O,className:q("virtual-table-header",t,{"virtual-table-header-sticky":l}),style:{top:Number.isFinite(l)?l:void 0},children:D}),f,{columns:m,columnDescriptor:c})},vt=s.memo(kt);function Ht(e,t){let n=0,r=e.length-1,o=-1;for(;n<=r;){const l=Math.floor((n+r)/2);e[l].right>t?(o=l,r=l-1):n=l+1}if(o!==-1)return e[o]}function Et(e){let t=-1;for(let n=e.length-1;n>=0;n--){const r=e[n];if(Q(r.fixed))t=n;else break}return t}function Mt(e){return Ce(e,t=>G(t.fixed))}function Tt(e){const{estimateSize:t,defaultColumnWidth:n,overscan:r,columns:o,bodyWrapper:l,columnWidths:f,disabled:a=!1}=e,d=Mt(o),i=Et(o),C=d>-1?Y(o[d]):null,m=i>-1?Y(o[i]):null,[c,p]=s.useState(0),[S,M]=s.useState(0),b=s.useMemo(()=>{if(a)return[];let u=0;return o.map((T,k)=>{const g=Y(T),L=f.get(g)??t,W=u+L,v={index:k,width:L,left:u,right:W};return u=W,v})},[o,f,t,a]),w=s.useRef({index:0,width:t,left:0,right:t}),j=We(u=>Ht(b,u)),I=We((u,T)=>{const k=j(u);k!=null&&(w.current=k,p(Math.max(0,k.index-r)),M(k.index+T+r))}),B=s.useRef(0);s.useEffect(()=>{if(a)return;const u=l.current;if(u==null)return;const T=u.offsetWidth;let k=Math.ceil(T/t);const g=()=>{const v=u.scrollLeft;v>B.current?v>w.current.right&&I(v,k):v<w.current.left&&I(v,k),B.current=v};u.addEventListener("scroll",g);let L=0;const W=xe(u,({width:v})=>{if(v===L||v===0)return;L=v;const A=u.scrollLeft;k=Math.ceil(v/t),I(A,k)});return()=>{u.removeEventListener("scroll",g),W()}},[l,t,I,r,j,a]);const _=(u,T)=>b.slice(u,T).reduce((k,g)=>k+g.width,0),F=d>-1?_(0,d+1):0,D=i>-1?_(i):0,O=Math.max(0,_(0,c)-F),H=Math.max(0,_(S)-D),h=s.useMemo(()=>{if(a)return o;const u=[...o.slice(0,d+1),...o.slice(c,S),...o.slice(i)],T=new Set;return u.filter(k=>{const g=Y(k);return T.has(g)?!1:(T.add(g),!0)})},[a,o,c,S,d,i]),x=s.useMemo(()=>h.reduce((u,T,k)=>{const g=Y(T);let L=T;return L.width==null&&L.minWidth==null&&(L={...L,width:n}),g===C?(u.push({type:"normal",key:g,column:L}),u.push({type:"blank",key:"_blank_left",width:O})):C==null&&k===0?(u.push({type:"blank",key:"_blank_left",width:O}),u.push({type:"normal",key:g,column:L})):g===m?(u.push({type:"blank",key:"_blank_right",width:H}),u.push({type:"normal",key:g,column:L})):m==null&&k===h.length-1?(u.push({type:"normal",key:g,column:L}),u.push({type:"blank",key:"_blank_right",width:H})):u.push({type:"normal",key:g,column:L}),u},[]),[h,C,m,O,H,n]);return{columns:s.useMemo(()=>({columns:h,descriptor:x}),[h,x]),columnSlice:h,lastFixedLeftIndex:d,firstFixedRightIndex:i}}function Lt(e,t){const{className:n,style:r,children:o,hasFixedLeftColumn:l,hasFixedRightColumn:f,renderRoot:a,bodyScrollContainer:d}=e,i=s.useRef(null),[C,m]=s.useState(!1),[c,p]=s.useState(!1),{listen:S}=me();s.useEffect(()=>{if(!l&&!f)return;const b=j=>{const{scrollLeft:I,clientWidth:B,scrollWidth:_}=j;l&&m(I!==0),f&&p(!(I+B>=_))},w=d.current;return w!=null&&b(w),S("__root",(j,I)=>{b(I)})},[d,l,f,S]);const M=re(t,i);return P(R.jsx("div",{ref:M,className:q("virtual-table",C&&"virtual-table-has-fix-left",c&&"virtual-table-has-fix-right",n),style:r,children:o}),a,{})}const Wt=s.forwardRef(Lt);function It(e,t){const{bodyRootRef:n,instance:r,className:o,style:l,tableBodyClassName:f,tableBodyStyle:a,columns:d,dataSource:i,rowKey:C="key",estimatedRowHeight:m=46,estimatedColumnWidth:c,overscanRows:p=5,overscanColumns:S=3,stickyHeader:M,defaultColumnWidth:b=100,pipeline:w=ie.defaultPipeline,rowClassName:j,onRow:I,getOffsetTop:B,virtualHeader:_=!0}=e,F=yt(r),D=s.useRef(null),O=s.useRef(null),H=s.useRef(null),h=s.useRef(null),x=re(h,n),y=s.useRef(null),u=s.useCallback(()=>{const E=D.current;if(E!=null)return ct(E)},[]),T=s.useCallback(()=>{if(typeof B=="function")return B();const E=u(),z=D.current;if(z==null||E==null||E===z)return 0;if(pe(E)||De(E)){const U=z.getBoundingClientRect().top;return window.scrollY+U}return ut(z,E)},[B,u]),{dataSource:k,columns:g,rowKey:L,rowClassName:W,render:v,renderRoot:A,renderContent:V,renderHeaderWrapper:oe,renderHeaderRoot:ue,renderHeader:ye,renderHeaderRow:ae,renderHeaderCell:ge,renderBodyWrapper:N,renderBodyRoot:$,renderBody:K,renderBodyContent:ne,renderRow:X,renderCell:Se,onRow:J}=w.use({dataSource:i,rowKey:C,columns:d,estimatedRowHeight:m,headerWrapperRef:O,bodyWrapperRef:H,bodyRootRef:h,bodyRef:y,rootRef:D,getOffsetTop:T,getScroller:u,instance:F}),[Z,Ae]=s.useState(()=>new Map),ke=s.useRef(Z),ve=s.useCallback(E=>{const z=new Map(ke.current);E.forEach((U,te)=>{z.set(te,U)}),ke.current=z,Ae(z)},[]),Ve=s.useMemo(()=>({widthList:Z,setWidthList:ve}),[Z,ve]),{columns:ee}=Tt({estimateSize:c??b,defaultColumnWidth:b,overscan:S,columns:g,bodyWrapper:H,columnWidths:Z,disabled:c==null}),$e=s.useCallback((E,z)=>q(j==null?void 0:j(E,z),W==null?void 0:W(E,z)),[j,W]),qe=s.useCallback((E,z)=>({...I==null?void 0:I(E,z),...J==null?void 0:J(E,z)}),[J,I]),Ye=g.some(E=>G(E.fixed)),Ge=g.some(E=>Q(E.fixed)),He=s.useMemo(()=>({columns:g,descriptor:g.map(E=>({key:Y(E),type:"normal",column:E}))}),[g]),Qe=s.useMemo(()=>_?ee:He,[_,He,ee]),se=F.getInternalHooks();se.implGetCurrentProps(()=>e),se.implGetDOM(()=>({root:D.current,headerWrapper:O.current,bodyWrapper:H.current,bodyRoot:h.current,body:y.current})),se.implScrollTo(E=>{var te;const{left:z,top:U}=E;if(z!=null&&((te=H.current)==null||te.scrollTo(E)),U!=null){const le=u();if(le==null){console.error("The scroller DOM is not obtained, and scrolling is not possible.");return}le.scrollTo(E)}}),se.implScrollValueByColumnKey(E=>{let z=0,U=0;for(const te of g){const le=Y(te),Ee=Z.get(le)??0;if(G(te.fixed)&&(U+=Ee),le===E)break;z+=Ee}return z-U}),se.implScrollToColumn(E=>{F.scrollTo({left:F.getScrollValueByColumnKey(E)})});const Ue=P(R.jsxs(R.Fragment,{children:[R.jsx(vt,{wrapperRef:O,columns:Qe,stickyHeader:M,renderHeaderWrapper:oe,renderHeaderRoot:ue,renderHeader:ye,renderHeaderRow:ae,renderHeaderCell:ge}),R.jsx(St,{instance:F,bodyWrapperRef:H,bodyRootRef:x,bodyRef:y,className:f,style:a,columns:ee,rowKey:L,dataSource:k,overscan:p,estimateSize:m,getScroller:u,getOffsetTop:T,rowClassName:$e,onRow:qe,renderBodyWrapper:N,renderBodyRoot:$,renderBody:K,renderBodyContent:ne,renderRow:X,renderCell:Se})]}),V,{columns:ee.columns,columnDescriptor:ee.descriptor}),Xe=re(D,t),Je=P(R.jsx(Wt,{ref:Xe,className:o,style:l,hasFixedLeftColumn:Ye,hasFixedRightColumn:Ge,renderRoot:A,bodyScrollContainer:H,children:Ue}),v,{columns:ee.columns,columnDescriptor:ee.descriptor});return R.jsx(Ne.Provider,{value:Ve,children:R.jsx(tt,{columns:g,children:R.jsx(dt,{getScroller:u,root:D,children:R.jsx(ft,{children:Je})})})})}const Kt=s.memo(s.forwardRef(It));function jt(){const e=document.createElement("div");e.style.position="absolute",e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.top="-9999px",document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth,n=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),{width:t,height:n}}const Nt=e=>{const{className:t,style:n,bottom:r,zIndex:o,bodyRef:l}=e,{listen:f,notify:a}=me(),d=s.useRef(null);s.useEffect(()=>{const c=d.current;if(c==null)return;const p="virtual-table-sticky-bottom-scroll",S=()=>{a(p,{scrollLeft:()=>c.scrollLeft,node:c})},M=f(p,b=>{c.scrollLeft=b});return c.addEventListener("scroll",S),()=>{c.removeEventListener("scroll",S),M()}},[f,a]);const[i,C]=s.useState(0);s.useEffect(()=>{const c=l.current;if(c!=null)return xe(c,({width:p})=>{p!==0&&C(p)})},[l]);const[m]=s.useState(jt);return R.jsx("div",{className:q("virtual-table-sticky-scroll",t),style:{...n,"--virtual-table-sticky-scroll-bottom":Number.isFinite(r)?`${r}px`:r,paddingTop:m.height>0?0:15,marginTop:m.height>0?0:m.height*-1,height:m.height+1,zIndex:o},ref:d,children:R.jsx("div",{className:"virtual-table-sticky-scroll-bar",style:{width:i}})})};function Bt(e,t){const{bodyRootRef:n}=e;return{...e,renderContent(r){return R.jsxs(R.Fragment,{children:[r,R.jsx(Nt,{bodyRef:n,...t})]})}}}const Pt=gt(Bt);export{Fe as C,Kt as V,gt as a,Ot as b,q as c,Dt as d,Te as e,We as f,Y as g,Pt as h,je as i,fe as j,ze as k,Q as l,G as m,Ce as n,xe as o,me as p,jt as q,re as r,_t as u};

var Ze=Object.defineProperty;var et=(e,t,n)=>t in e?Ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var we=(e,t,n)=>et(e,typeof t!="symbol"?t+"":t,n);import{r as s,j as S}from"./index-C5G4hb-v.js";function Ie(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(n=Ie(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function q(){for(var e,t,n=0,r="",o=arguments.length;n<o;n++)(e=arguments[n])&&(t=Ie(e))&&(r&&(r+=" "),r+=t);return r}function Be(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=Object.keys(e),r=Object.keys(t),o=n.length;if(r.length!==o)return!1;for(let l=0;l<o;l+=1){const h=n[l];if(e[h]!==t[h]||!Object.prototype.hasOwnProperty.call(t,h))return!1}return!0}function Re(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=e.length;if(t.length!==n)return!1;for(let r=0;r<n;r+=1)if(e[r]!==t[r])return!1;return!0}function ue(e,t){if(Object.is(e,t))return!0;if(Array.isArray(e)&&Array.isArray(t))return Re(e,t)?!0:e.length===t.length&&e.findIndex(r=>typeof r=="object"&&r!=null)>-1?e.every((r,o)=>Array.isArray(r)?Re(r,t[o]):typeof r=="object"&&r!=null?Be(r,t[o]):Object.is(r,t[o])):!1;if(e instanceof Map&&t instanceof Map){const n=Array.from(e.keys()),r=Array.from(t.keys());if(ue(n,r)){const o=Array.from(e.values()),l=Array.from(t.values());if(ue(o,l))return!0}return!1}return typeof e=="object"&&e!=null?Be(e,t):!1}function xe(e){const t=e(),n=s.useRef(t);return ue(t,n.current)||(n.current=t),n.current}function A(e){return"key"in e?e.key:e.dataIndex}function ie(e,t){return typeof t=="function"?t(e):e[t]}function U(e){return e==="left"}function Q(e){return e==="right"}function We(e){return U(e)||Q(e)}const je=s.createContext(null);function Ne(){const e=s.useContext(je);if(e==null)throw new Error("useColumnSizes provider not found");return e}const Le=s.createContext(null);function tt(e){const{columns:t,children:n}=e,{widthList:r}=Ne(),o=s.useMemo(()=>t.map(a=>({key:A(a),fixed:a.fixed})),[t]),l=s.useMemo(()=>{let a=0;const x=o.reduce((f,g,v)=>{const{fixed:d,key:c}=g;return U(d)&&(f[v]=a,a+=r.get(c)??0),f},[]);let m=0;const b=o.reduceRight((f,g,v)=>{const{fixed:d,key:c}=g;return Q(d)&&(f[v]=m,m+=r.get(c)??0),f},[]);return o.reduce((f,g,v)=>{const{key:d,fixed:c}=g;return U(c)?(f.set(d,x[v]),f):(Q(c)&&f.set(d,b[v]),f)},new Map)},[o,r]),h=xe(()=>o),u=xe(()=>l),i=s.useMemo(()=>({size:u,fixed:h}),[h,u]);return S.jsx(Le.Provider,{value:i,children:n})}function ze(){const e=s.useContext(Le);if(e==null)throw new Error("useTableSticky provider not found");return e}function _(e,t,n){return typeof t=="function"?t(e,n):e}function nt(e,t,n){const{render:r}=n,o=t;if("dataIndex"in n){const l=n.dataIndex;return typeof r!="function"?o[l]:r(o[l],t,e)}return(r==null?void 0:r(t,t,e))??null}function rt(e){const{className:t,style:n,column:r,rowData:o,rowIndex:l,renderCell:h,...u}=e,{align:i,fixed:a,onCell:x}=r,m=A(r),{size:b}=ze(),{className:f,style:g,colSpan:v,rowSpan:d,...c}=(x==null?void 0:x(o,l))??{};return v===0||d===0?null:_(S.jsx("td",{...u,...c,colSpan:v,rowSpan:d,className:q("virtual-table-cell",i!=null&&`virtual-table-align-${i}`,We(a)&&"virtual-table-sticky-cell",t,r.className,f),style:{...n,...g,left:U(a)?b.get(m):void 0,right:Q(a)?b.get(m):void 0},"data-col-key":m,children:nt(l,o,r)}),h,{column:r})}const ot=s.memo(rt);function de(e,t){return Number.isFinite(e.width)?e.width:t}const st=e=>{const{columns:t,defaultColumnWidth:n}=e;return S.jsx("colgroup",{children:t.map(r=>{const{key:o}=r;if(r.type==="blank")return S.jsx("col",{className:"blank",style:{width:r.width}},o);const{column:l}=r,h=de(l,n);return S.jsx("col",{"data-col-key":o,style:{width:h}},o)})})},Fe=s.memo(st),Ke=s.createContext(null);function Pt(){const e=s.useContext(Ke);if(e==null)throw new Error("useContainerSize provider not found");return e}const De=s.createContext(null);function lt(e){const{children:t}=e,n=s.useRef(new Map),r=s.useMemo(()=>{const o=new Set;return{listen(l,h){return n.current.set(l,(u,i)=>{h(u,i)}),()=>{n.current.delete(l)}},notify(l,h){if(o.has(l)){o.delete(l);return}const{scrollLeft:u,node:i}=h;let a=window.requestAnimationFrame;a==null&&(a=x=>{x()}),n.current.forEach((x,m)=>{l!==m&&(o.add(m),a(()=>{x(u(),i)}))})}}},[]);return S.jsx(De.Provider,{value:r,children:t})}function Oe(){const e=s.useContext(De);if(e==null)throw new Error("useHorizontalScrollContext provider not found");return e}function Se(e){const{listen:t,notify:n}=Oe(),r=s.useRef(null);return s.useEffect(()=>{const o=r.current;if(o==null)return;const l=()=>{n(e,{scrollLeft:()=>o.scrollLeft,node:o})},h=()=>{o.addEventListener("scroll",l,{passive:!0})},u=()=>{o.removeEventListener("scroll",l)},i=t(e,a=>{o.style.willChange="scroll-position",o.scrollLeft=a});return h(),()=>{u(),i()}},[e,t,n]),r}const _e=s.createContext(null);function At(){const e=s.useContext(_e);if(e==null)throw new Error("useTableRowManager provider not found");return e}const ct=/auto|scroll|overlay|hidden/;function Pe(e){return e instanceof Node?e.nodeType===1:!1}function it(e,t=window){let n=e;for(;n!==t&&Pe(n);){if(n===document.body)return t;const{overflow:r,overflowY:o,overflowX:l}=window.getComputedStyle(n);if(ct.test(r+o+l))return n;n=n.parentNode}return e.ownerDocument.defaultView??window}function fe(e){return Object.prototype.toString.call(e)==="[object Window]"}function ut(e){return Object.prototype.toString.call(e)==="[object HTMLDocument]"}function Ae(e){return Object.prototype.toString.call(e)==="[object HTMLHtmlElement]"}function Te(e){return ut(e)?e.scrollingElement:Pe(e)?e:document.scrollingElement}function at(e,t){const n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),o=Number.parseFloat(window.getComputedStyle(t).borderTopWidth)||0,l=t.scrollTop;return n.top-r.top-o+l}function ve(e,t){if(fe(e)){const n=()=>{t({width:window.innerWidth,height:window.innerHeight})};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}}else{const n=new ResizeObserver(r=>{const o=r[0].contentRect;t({width:o.width,height:o.height})});return n.observe(e),()=>{n.disconnect()}}}function dt(e){const t=s.useRef();return t.current==null&&(t.current=e()),t}const be="NormalRow";function ft(e){const t=s.useRef(null);if(t.current==null){const n=new Map;t.current=e(n)}else t.current=e(t.current);return t}function ht(e){const{debugKey:t,estimateSize:n,dataSource:r,rowKey:o,nodeHeightValid:l}=e,[h,u]=s.useState(()=>new Map),i=ft(d=>r.length===0?(d.clear(),d):(r.forEach(c=>{const M=ie(c,o),y=d.get(M)??new Map;y.get(be)==null&&y.set(be,n),d.set(M,y)}),d)),a=()=>{const d=[];return r.forEach(c=>{const M=ie(c,o),y=i.current.get(M);if(y==null)d.push(n);else{let I=0;y.forEach(W=>I+=W),d.push(I)}}),d},[x,m]=s.useState(a),b=()=>{const{rects:d}=r.reduce((c,M,y)=>{var j;const I=ie(M,o);let W=0;(j=i.current.get(I))==null||j.forEach(B=>{W+=B});const F=c.top+W;return c.rects.push({index:y,top:c.top,height:W,bottom:F}),c.top=F,c},{top:0,rects:[]});return d},f=dt(b),g=s.useRef(new Map),v=s.useCallback((d,c,M)=>{const y=g.current.get(d)??new Map;y.set(c,M),g.current.set(d,y)},[]);return s.useLayoutEffect(()=>{if(!l())return;let d=!1;g.current.forEach((c,M)=>{const y=i.current.get(M)??new Map;c.forEach((I,W)=>{const F=I();if(t==="demo1"&&F===0){debugger;I()}const j=y.get(W);if(F!=null&&(j==null||j!==F)&&(d=!0,y.set(W,F),t==="demo1"&&F===0))debugger;i.current.set(M,y)})}),g.current.clear(),(d||r.length!==x.length)&&(d=!1,u(new Map(i.current)),m(a()),f.current=b())}),{rowHeightByRowKey:h,rowHeightByRowKeyRef:i,setRowHeightByRowKey:v,rowHeights:x,rowRectsRef:f}}function yt(e,t){let n=0,r=e.length-1,o=-1;for(;n<=r;){const l=Math.floor((n+r)/2);e[l].bottom>t?(o=l,r=l-1):n=l+1}if(o!==-1)return e[o]}function pt(e){const{debugKey:t,nodeHeightValid:n,getOffsetTop:r,rowKey:o,dataSource:l,getScroller:h,estimateSize:u,overscan:i}=e,{rowHeightByRowKeyRef:a,setRowHeightByRowKey:x,rowRectsRef:m,rowHeights:b}=ht({dataSource:l,rowKey:o,debugKey:t,estimateSize:u,nodeHeightValid:n}),[f,g]=s.useState(0),[v,d]=s.useState(0),c=s.useRef();s.useLayoutEffect(()=>{const w=c.current;w!=null&&n()&&(w(),c.current=void 0)});const M=s.useMemo(()=>l.slice(f,v),[l,f,v]),y=s.useRef({index:0,height:u,top:0,bottom:u}),I=l.length,W=s.useRef(0),F=s.useRef(!1);s.useEffect(()=>{const w=h();if(w==null)return;let H=0;const P=()=>{const R=r();let N=0;return fe(w)||Ae(w)?N=window.scrollY:N=Te(w).scrollTop,Math.max(N-R,0)},p=R=>{const N=H;return H=Math.ceil(R/u),{prevCount:N}},k=R=>{const N=yt(m.current,R);N!=null&&(y.current=N,g(Math.max(0,N.index-i)),d(N.index+H+i))},T=R=>{const N=r(),O=Te(R.target),K=Math.max(0,O.scrollTop-N);K>W.current?K>y.current.bottom&&(n()?k(K):c.current=()=>k(K)):K<y.current.top&&(n()?k(K):c.current=()=>k(K)),W.current=K};let E=0;const z=ve(w,R=>{if(R.height===E||R.height===0)return;E=R.height,p(R.height);const N=P();if(F.current)k(N);else{F.current=!0;let O=0;N>=u&&(O=Math.max(Math.floor(N/u)-1-i,0));const K=O+H+i;g(O),d(K)}});return w.addEventListener("scroll",T),()=>{z(),w.removeEventListener("scroll",T)}},[u,r,h,i,I,n,m]);const j=(w,H)=>b.slice(w,H).reduce((P,p)=>P+p,0),B=j(0,f),D=j(v);return{startIndex:f,endIndex:v,rowHeightList:b,rowHeightByRowKeyRef:a,setRowHeightByRowKey:x,topBlank:B,bottomBlank:D,dataSlice:M}}function Ce(e){const t=s.useRef(null);return s.useLayoutEffect(()=>{t.current=e}),s.useCallback((...r)=>{var o;return(o=t.current)==null?void 0:o.call(t,...r)},[])}class mt{constructor(){this.getInstance=this.getInstance.bind(this)}getInstance(){const n={...["getCurrentProps","getColumns","getDataSource","getDOM","getRowHeightMap","getRowVirtualizeState","getScrollValueByRowIndex","getScrollValueByColumnKey","scrollToRow","scrollToColumn","scrollTo","getColumnByKey","getColumnByIndex","getColumnKeyByIndex","getColumnWidths","getColumnWidthByKey"].reduce((r,o)=>(r[o]=()=>{throw new Error(`${o}() has not been implemented yet`)},r),{}),extend:r=>{Object.keys(r).forEach(o=>{n[o]=r[o]})}};return n}}function gt(e){const[t]=s.useState(()=>e??new mt().getInstance());return t}function wt(e){const t={current:null,options:null};return(...n)=>{const r=o=>e(o,...n);return ue(n,t.options)?t.current??r:(t.options=n,t.current=r,r)}}function Rt(e){return Array.isArray(e)?e.filter(t=>t!=null&&(typeof t=="function"||typeof t.hook=="function")).map(t=>typeof t=="function"?{priority:100,hook:t}:t):[]}const ae=class ae{constructor(){we(this,"hooks",[]);this.use=this.use.bind(this)}setHooks(t){this.hooks=t}use(t){if(this.hooks.length===0)return t;const n={current:t},r={render:[],renderRoot:[],renderContent:[],renderHeaderWrapper:[],renderHeaderRoot:[],renderHeader:[],renderHeaderRow:[],renderHeaderCell:[],renderBodyWrapper:[],renderBodyRoot:[],renderBody:[],renderBodyContent:[],renderRow:[],renderCell:[]},o=[],l=[],h=this.hooks.slice();return h.sort((u,i)=>u.priority-i.priority),h.map(u=>u.hook).forEach(u=>{const i=u(n.current),{render:a,renderRoot:x,renderContent:m,renderHeaderWrapper:b,renderHeaderRoot:f,renderHeader:g,renderHeaderRow:v,renderHeaderCell:d,renderBodyWrapper:c,renderBodyRoot:M,renderBody:y,renderBodyContent:I,renderRow:W,renderCell:F,rowClassName:j,onRow:B,...D}=i;Object.entries(r).forEach(([w,H])=>{const P=i[w];typeof P=="function"&&H.push(P)}),typeof j=="function"&&o.push(j),typeof B=="function"&&l.push(B),n.current=D}),Object.entries(r).forEach(([u,i])=>{i.length>0&&(n.current[u]=(a,x)=>i.reduce((m,b)=>b(m,x),a))}),o.length>0&&(n.current.rowClassName=(u,i)=>q(...o.map(a=>a(u,i)))),l.length>0&&(n.current.onRow=(u,i)=>l.reduce((a,x)=>({...a,...x(u,i)}),{})),n.current}};we(ae,"defaultPipeline",new ae);let ne=ae;function Vt(e){const{use:t,pipeline:n}=e,r=s.useMemo(()=>({current:new ne}),[]);if(t!=null){const o=Rt([...t,...(n==null?void 0:n.hooks)??[]]);if(!Re(r.current.hooks,o)){const l=new ne;return l.setHooks(o),r.current=l,l}}return r.current}function ke(e,t){let n=-1;for(let r=0;r<e.length;r+=1)t(e[r],r)&&(n=r);return n}function xt(e){const{className:t,rowKey:n,rowIndex:r,rowData:o,columns:l,onRow:h,renderRow:u,renderCell:i,onRefCallback:a,...x}=e,{columns:m,descriptor:b}=l,f=ke(b,c=>c.type==="blank"?!1:U(c.column.fixed)),g=b.findIndex(c=>c.type==="blank"?!1:Q(c.column.fixed)),{className:v,...d}=(h==null?void 0:h(o,r))??{};return _(S.jsx("tr",{...x,...d,className:q("virtual-table-row",t,v),"data-row-index":r,ref:c=>{a==null||a({node:c,rowKey:n,rowIndex:r,rowData:o})},children:b.map((c,M)=>{const{key:y}=c;if(c.type==="blank")return S.jsx("td",{},y);const{column:I}=c;return S.jsx(ot,{className:q(f===M&&"virtual-table-cell-fix-left-last",g===M&&"virtual-table-cell-fix-right-first"),column:I,rowIndex:r,rowData:o,renderCell:i},y)})}),u,{columns:m,rowKey:n,rowIndex:r,rowData:o,columnDescriptor:b})}const bt=s.memo(xt);function Ct(e,t){typeof e=="function"?e(t):typeof e=="object"&&e!==null&&"current"in e&&(e.current=t)}function St(...e){return t=>{e.forEach(n=>Ct(n,t))}}function ee(...e){return s.useCallback(St(...e),e)}function vt(){const e=s.useRef(null),t=Ce(()=>{const n=e.current;return n==null?!1:n.offsetHeight>0});return[e,t]}function kt(e){const{debugKey:t,bodyWrapperRef:n,bodyRootRef:r,bodyRef:o,className:l,style:h,defaultColumnWidth:u,dataSource:i,columns:a,rowKey:x,instance:m,overscan:b,estimateSize:f,getScroller:g,getOffsetTop:v,rowClassName:d,onRow:c,renderBodyWrapper:M,renderBodyRoot:y,renderBody:I,renderBodyContent:W,renderRow:F,renderCell:j}=e,[B,D]=vt(),{startIndex:w,endIndex:H,dataSlice:P,rowHeightByRowKeyRef:p,setRowHeightByRowKey:k,rowHeightList:T,topBlank:E,bottomBlank:z}=pt({debugKey:t,nodeHeightValid:D,getOffsetTop:v,rowKey:x,dataSource:i,getScroller:g,estimateSize:f,overscan:b});m.extend({getRowVirtualizeState:()=>({startIndex:w,endIndex:H,overscan:b,estimateSize:f}),getRowHeightMap:()=>p.current});const R=ee(o,B),N=s.useCallback(V=>{const{node:Y,rowKey:$}=V;k($,be,()=>{if(Y!=null)return Y.offsetHeight})},[k]),{columns:O,descriptor:K}=a,re=_(P.map((V,Y)=>{const $=ie(V,x);return S.jsx(bt,{className:q(d==null?void 0:d(V,Y)),rowKey:$,rowIndex:Y+w,rowData:V,columns:a,onRow:c,renderRow:F,renderCell:j,onRefCallback:N},$)}),W,{columns:O,columnDescriptor:K,startRowIndex:w}),he=_(S.jsx("tbody",{ref:R,children:re}),I,{columns:O,columnDescriptor:K,startRowIndex:w}),ye=_(S.jsxs("table",{className:q(l,"virtual-table-body"),style:{...h,paddingBottom:z,paddingTop:E},ref:r,children:[S.jsx(Fe,{columns:K,defaultColumnWidth:u}),he]}),y,{columns:O,columnDescriptor:K,startRowIndex:w}),pe=Se("virtual-table-body"),me=ee(pe,n);m.extend({getScrollValueByRowIndex(V){if(g()==null)return 0;const{stickyHeader:$}=m.getCurrentProps(),{headerWrapper:oe}=m.getDOM();let te=0;return $==null||$===!1?te=oe==null?0:oe.offsetHeight:te=Number.isFinite($)?$*-1:0,T.slice(0,V).reduce((se,G)=>se+G,0)+v()+te},scrollToRow(V,Y){m.scrollTo({top:m.getScrollValueByRowIndex(V),behavior:Y})}});const ge=s.useMemo(()=>({getRowHeightList:()=>T,setRowHeightByRowKey:k}),[T,k]);return S.jsx(_e.Provider,{value:ge,children:_(S.jsx("div",{ref:me,className:"virtual-table-body-wrapper",children:ye}),M,{columns:O,columnDescriptor:K,startRowIndex:w})})}const Ht=e=>{const{className:t,style:n,defaultColumnWidth:r,wrapperRef:o,columns:l,stickyHeader:h,renderHeaderWrapper:u,renderHeaderRoot:i,renderHeader:a,renderHeaderRow:x,renderHeaderCell:m}=e,{columns:b,descriptor:f}=l,g=b[b.length-1],{widthList:v}=Ne(),{size:d}=ze(),c=ke(f,B=>B.type==="blank"?!1:U(B.column.fixed)),M=f.findIndex(B=>B.type==="blank"?!1:Q(B.column.fixed)),y=Se("virtual-table-header"),I=_(S.jsx("tr",{children:f.map((B,D)=>{var E;const{key:w}=B;if(B.type==="blank")return S.jsx("th",{"data-blank":!0},w);const{column:H}=B;if(H.colSpan===0)return null;const P=A(g)===w,{className:p,style:k,...T}=((E=H.onHeaderCell)==null?void 0:E.call(H,H,D))??{};return S.jsx(s.Fragment,{children:_(s.createElement("th",{scope:"col",...T,colSpan:H.colSpan,className:q("virtual-table-header-cell",P&&"no-split",H.align!=null&&`virtual-table-align-${H.align}`,We(H.fixed)&&"virtual-table-sticky-cell",c===D&&"virtual-table-cell-fix-left-last",M===D&&"virtual-table-cell-fix-right-first",H.className,p),style:{...k,left:U(H.fixed)?d.get(w):void 0,right:Q(H.fixed)?d.get(w):void 0}},H.title),m,{column:H,columns:b,columnWidths:v,columnDescriptor:f})},w)})}),x,{columns:b,columnDescriptor:f}),W=_(S.jsx("thead",{className:"virtual-table-thead",children:I}),a,{columns:b,columnDescriptor:f}),F=_(S.jsxs("table",{style:n,children:[S.jsx(Fe,{columns:f,defaultColumnWidth:r}),W]}),i,{columns:b,columnDescriptor:f}),j=ee(o,y);return _(S.jsx("div",{ref:j,className:q("virtual-table-header",t,{"virtual-table-header-sticky":h}),style:{top:Number.isFinite(h)?h:void 0},children:F}),u,{columns:b,columnDescriptor:f})},Mt=s.memo(Ht);function Et(e){const{getScroller:t,root:n}=e,[r,o]=s.useState(0),[l,h]=s.useState(0),[u,i]=s.useState(800),[a,x]=s.useState(600),m=s.useRef(null);return s.useLayoutEffect(()=>{const f=t();if(f==null)return;let g;fe(f)?g=document.scrollingElement:g=f,m.current=g;const v=new ResizeObserver(d=>{const{width:c,height:M}=d[0].contentRect;o(c),h(M)});return v.observe(g),()=>{v.disconnect()}},[t]),s.useLayoutEffect(()=>{const f=n.current;if(f==null)return;const g=new ResizeObserver(v=>{const{width:d,height:c}=v[0].contentRect;i(d),x(c)});return g.observe(f),()=>{g.disconnect()}},[n]),s.useMemo(()=>({scrollContainerWidth:r,scrollContainerHeight:l,tableWidth:u,tableHeight:a}),[r,l,u,a])}function Bt(e,t){const n=s.useMemo(()=>e.reduce((r,o)=>{const l=de(o,t);return r.set(A(o),l),r},new Map),[e,t]);return xe(()=>n)}function Tt(e,t){let n=0,r=e.length-1,o=-1;for(;n<=r;){const l=Math.floor((n+r)/2);e[l].right>t?(o=l,r=l-1):n=l+1}if(o!==-1)return e[o]}function It(e){let t=-1;for(let n=e.length-1;n>=0;n--){const r=e[n];if(Q(r.fixed))t=n;else break}return t}function Wt(e){return ke(e,t=>U(t.fixed))}function jt(e){const{estimateSize:t,defaultColumnWidth:n,overscan:r,columns:o,containerWidth:l,bodyWrapper:h,disabled:u=!1}=e,i=Wt(o),a=It(o),x=i>-1?A(o[i]):null,m=a>-1?A(o[a]):null,[b,f]=s.useState(0),[g,v]=s.useState(0),d=s.useMemo(()=>{if(u)return[];let p=0;return o.map((k,T)=>{const E=de(k,n),z=p+E,R={index:T,width:E,left:p,right:z};return p=z,R})},[u,o,n]),c=s.useRef({index:0,width:t,left:0,right:t}),M=Ce(p=>Tt(d,p)),y=Ce((p,k)=>{const T=M(p);T!=null&&(c.current=T,f(Math.max(0,T.index-r)),v(T.index+k+r))}),I=s.useRef(0);s.useEffect(()=>{if(u)return;const p=h.current;if(p==null)return;let k=Math.ceil(l/t);const T=()=>{const R=p.scrollLeft;R>I.current?R>c.current.right&&y(R,k):R<c.current.left&&y(R,k),I.current=R};p.addEventListener("scroll",T);let E=0;const z=ve(p,({width:R})=>{if(R===E||R===0)return;E=R;const N=p.scrollLeft;k=Math.ceil(R/t),y(N,k)});return()=>{p.removeEventListener("scroll",T),z()}},[l,h,t,y,r,M,u]);const W=(p,k)=>d.slice(p,k).reduce((T,E)=>T+E.width,0),F=i>-1?W(0,i+1):0,j=a>-1?W(a):0,B=Math.max(0,W(0,b)-F),D=Math.max(0,W(g)-j),w=s.useMemo(()=>{if(u)return o;const p=[...o.slice(0,i+1),...o.slice(b,g),...o.slice(a)],k=new Set;return p.filter(T=>{const E=A(T);return k.has(E)?!1:(k.add(E),!0)})},[u,o,b,g,i,a]),H=s.useMemo(()=>w.reduce((p,k,T)=>{const E=A(k);let z=k;return z.width==null&&z.minWidth==null&&(z={...z,width:n}),u?p.push({type:"normal",key:E,column:z}):E===x?(p.push({type:"normal",key:E,column:z}),p.push({type:"blank",key:"_blank_left",width:B})):x==null&&T===0?(p.push({type:"blank",key:"_blank_left",width:B}),p.push({type:"normal",key:E,column:z})):E===m?(p.push({type:"blank",key:"_blank_right",width:D}),p.push({type:"normal",key:E,column:z})):m==null&&T===w.length-1?(p.push({type:"normal",key:E,column:z}),p.push({type:"blank",key:"_blank_right",width:D})):p.push({type:"normal",key:E,column:z}),p},[]),[w,u,n,x,m,B,D]);return{columns:s.useMemo(()=>({columns:w,descriptor:H}),[w,H]),columnSlice:w,lastFixedLeftIndex:i,firstFixedRightIndex:a}}function Nt(e,t){const{className:n,style:r,children:o,hasFixedLeftColumn:l,hasFixedRightColumn:h,renderRoot:u,bodyScrollContainer:i}=e,a=s.useRef(null),[x,m]=s.useState(!1),[b,f]=s.useState(!1),{listen:g}=Oe();s.useEffect(()=>{if(!l&&!h)return;const d=M=>{const{scrollLeft:y,clientWidth:I,scrollWidth:W}=M;l&&m(y!==0),h&&f(!(y+I>=W))},c=i.current;return c!=null&&d(c),g("__root",(M,y)=>{d(y)})},[i,l,h,g]);const v=ee(t,a);return _(S.jsx("div",{ref:v,className:q("virtual-table",x&&"virtual-table-has-fix-left",b&&"virtual-table-has-fix-right",n),style:r,children:o}),u,{})}const Lt=s.forwardRef(Nt);function zt(e,t){const{debugKey:n,bodyRootRef:r,instance:o,className:l,style:h,tableBodyClassName:u,tableBodyStyle:i,columns:a,dataSource:x,rowKey:m="key",estimatedRowHeight:b=46,estimatedColumnWidth:f,overscanRows:g=5,overscanColumns:v=3,stickyHeader:d,defaultColumnWidth:c=100,pipeline:M=ne.defaultPipeline,rowClassName:y,onRow:I,getOffsetTop:W,virtualHeader:F=!0}=e,j=gt(o);j.extend({getCurrentProps:()=>({estimatedRowHeight:b,overscanRows:g,overscanColumns:v,defaultColumnWidth:c,...e})});const B=s.useRef(null),D=s.useRef(null),w=s.useRef(null),H=s.useRef(null),P=ee(H,r),p=s.useRef(null),k=s.useCallback(()=>{const C=B.current;if(C!=null)return it(C)},[]),T=s.useCallback(()=>{if(typeof W=="function")return W();const C=k(),L=B.current;if(L==null||C==null||C===L)return 0;if(fe(C)||Ae(C)){const J=L.getBoundingClientRect().top;return window.scrollY+J}return at(L,C)},[W,k]),E=Et({getScroller:k,root:B}),{dataSource:z,columns:R,rowKey:N,rowClassName:O,render:K,renderRoot:re,renderContent:he,renderHeaderWrapper:ye,renderHeaderRoot:pe,renderHeader:me,renderHeaderRow:ge,renderHeaderCell:V,renderBodyWrapper:Y,renderBodyRoot:$,renderBody:oe,renderBodyContent:te,renderRow:He,renderCell:se,onRow:G}=M.use({dataSource:x,rowKey:m,columns:a,estimatedRowHeight:b,headerWrapperRef:D,bodyWrapperRef:w,bodyRootRef:H,bodyRef:p,rootRef:B,getOffsetTop:T,getScroller:k,instance:j});j.extend({getColumns:()=>R,getDataSource:()=>z});const le=Bt(R,c);j.extend({getColumnWidths:()=>le,getColumnWidthByKey:C=>le.get(C)});const Ve=s.useMemo(()=>({widthList:le}),[le]),{columns:X}=jt({estimateSize:f??c,defaultColumnWidth:c,overscan:v,columns:R,containerWidth:E.tableWidth,bodyWrapper:w,disabled:f==null}),$e=s.useCallback((C,L)=>q(y==null?void 0:y(C,L),O==null?void 0:O(C,L)),[y,O]),qe=s.useCallback((C,L)=>({...I==null?void 0:I(C,L),...G==null?void 0:G(C,L)}),[G,I]),Ye=R.some(C=>U(C.fixed)),Ue=R.some(C=>Q(C.fixed)),Me=s.useMemo(()=>({columns:R,descriptor:R.map(C=>({key:A(C),type:"normal",column:C}))}),[R]),Qe=s.useMemo(()=>F?X:Me,[F,Me,X]);j.extend({getDOM:()=>({root:B.current,headerWrapper:D.current,bodyWrapper:w.current,bodyRoot:H.current,body:p.current}),scrollTo:C=>{var Z;const{left:L,top:J}=C;if(L!=null&&((Z=w.current)==null||Z.scrollTo(C)),J!=null){const ce=k();if(ce==null){console.error("The scroller DOM is not obtained, and scrolling is not possible.");return}ce.scrollTo(C)}},getScrollValueByColumnKey:C=>{let L=0,J=0;for(const Z of R){const ce=A(Z),Ee=de(Z,c);if(U(Z.fixed)&&(J+=Ee),ce===C)break;L+=Ee}return L-J},scrollToColumn:(C,L)=>{j.scrollTo({left:j.getScrollValueByColumnKey(C),behavior:L})},getColumnByKey:C=>R.find(L=>A(L)===C),getColumnByIndex:C=>R[C],getColumnKeyByIndex:C=>{const L=j.getColumnByIndex(C);if(L!=null)return A(L)}});const Xe=_(S.jsxs(S.Fragment,{children:[S.jsx(Mt,{wrapperRef:D,defaultColumnWidth:c,columns:Qe,stickyHeader:d,renderHeaderWrapper:ye,renderHeaderRoot:pe,renderHeader:me,renderHeaderRow:ge,renderHeaderCell:V}),S.jsx(kt,{debugKey:n,instance:j,bodyWrapperRef:w,bodyRootRef:P,bodyRef:p,className:u,style:i,defaultColumnWidth:c,columns:X,rowKey:N,dataSource:z,overscan:g,estimateSize:b,getScroller:k,getOffsetTop:T,rowClassName:$e,onRow:qe,renderBodyWrapper:Y,renderBodyRoot:$,renderBody:oe,renderBodyContent:te,renderRow:He,renderCell:se})]}),he,{columns:X.columns,columnDescriptor:X.descriptor}),Ge=ee(B,t),Je=_(S.jsx(Lt,{ref:Ge,className:l,style:h,hasFixedLeftColumn:Ye,hasFixedRightColumn:Ue,renderRoot:re,bodyScrollContainer:w,children:Xe}),K,{columns:X.columns,columnDescriptor:X.descriptor});return S.jsx(je.Provider,{value:Ve,children:S.jsx(tt,{columns:R,children:S.jsx(Ke.Provider,{value:E,children:S.jsx(lt,{children:Je})})})})}const $t=s.memo(s.forwardRef(zt));function Ft(){const e=document.createElement("div");e.style.position="absolute",e.style.width="100px",e.style.height="100px",e.style.overflow="scroll",e.style.top="-9999px",document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth,n=e.offsetHeight-e.clientHeight;return document.body.removeChild(e),{width:t,height:n}}const Kt=e=>{const{className:t,style:n,bottom:r,zIndex:o,bodyRef:l}=e,h=Se("virtual-table-sticky-bottom-scroll"),[u,i]=s.useState(0);s.useEffect(()=>{const x=l.current;if(x!=null)return ve(x,({width:m})=>{m!==0&&i(m)})},[l]);const[a]=s.useState(Ft);return S.jsx("div",{className:q("virtual-table-sticky-scroll",t),style:{...n,"--virtual-table-sticky-scroll-bottom":Number.isFinite(r)?`${r}px`:r,paddingTop:a.height>0?0:15,marginTop:a.height>0?0:a.height*-1,height:a.height+1,zIndex:o},ref:h,children:S.jsx("div",{className:"virtual-table-sticky-scroll-bar",style:{width:u}})})};function Dt(e,t){const{bodyRootRef:n}=e;return{...e,renderContent(r){return S.jsxs(S.Fragment,{children:[r,S.jsx(Kt,{bodyRef:n,...t})]})}}}const qt=wt(Dt);export{Fe as C,$t as V,gt as a,wt as b,q as c,de as d,Pt as e,At as f,A as g,qt as h,Q as i,xe as j,Ce as k,We as l,ie as m,ze as n,U as o,ke as p,ve as q,Ft as r,Se as s,ee as t,Vt as u};
